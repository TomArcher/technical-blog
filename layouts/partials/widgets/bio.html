<div class="widget widget-bio">
  <h4 class="widget__title">Bio</h4>
  <div class="widget__content">

    {{/* Resolve avatar URL (params.avatar -> about bundle -> /static/img/avatar.jpg) */}}
    {{- $avatarURL := "" -}}
    {{- with .Site.Params.avatar -}}
      {{- $avatarURL = . | relURL -}}
    {{- end -}}
    {{- if eq $avatarURL "" -}}
      {{- with site.GetPage "/bio" -}}
        {{- with .Resources.GetMatch "avatar.*" -}}
          {{- $avatarURL = .RelPermalink -}}
        {{- end -}}
      {{- end -}}
    {{- end -}}
    {{- if and (eq $avatarURL "") (fileExists "static/img/avatar.jpg") -}}
      {{- $avatarURL = (relURL "img/avatar.jpg") -}}
    {{- end -}}

    <div class="bio-wrap">
      {{ with $avatarURL }}
        <a class="bio-avatar-link" href="{{ "/bio/" | relURL }}">
          <img class="bio-avatar" src="{{ . }}" alt="Avatar of {{ $.Site.Title }}">
        </a>
      {{ end }}

      {{/* Render bio as Markdown so render-link hook can add target=_blank to external links */}}
      {{ with .Site.Params.bio }}
        <div class="bio-text">{{ . | markdownify }}</div>
      {{ else }}
        {{ with site.GetPage "/bio" }}
          <div class="bio-text">{{ .RawContent | markdownify }}</div>
        {{ else }}
          <div class="bio-text">Add your bio to <code>params.bio</code> or create <code>content/bio/index.md</code>.</div>
        {{ end }}
      {{ end }}
    </div>

    <!-- Lightweight "Read more →" link -->
    <p class="more"><a class="link-more" href="{{ "/bio/" | relURL }}">Read more →</a></p>
  </div>
</div>
